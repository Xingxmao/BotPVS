document.addEventListener('DOMContentLoaded', () => {
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
    const socialButtonsContainer = document.getElementById('social-buttons');
    data.socialButtons.forEach(button => {
        const buttonElement = document.createElement('a');
        buttonElement.className = 'menu-item';
        buttonElement.href = button.link;
        buttonElement.target = '_blank';
        buttonElement.innerHTML = `<i class="${button.icon}"></i><span>${button.text}</span>`;
        socialButtonsContainer.appendChild(buttonElement);
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é
    const mainMenuItemsContainer = document.getElementById('main-menu-items');
    data.mainMenuItems.forEach(item => {
        const menuItem = document.createElement('a');
        menuItem.className = 'menu-item';
        menuItem.href = `#${item.section}`;
        menuItem.innerHTML = `<i class="${item.icon}"></i><span>${item.text}</span>`;
        menuItem.addEventListener('click', () => showSection(item.section));
        mainMenuItemsContainer.appendChild(menuItem);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ —Å—Å—ã–ª–∫–∞–º
    document.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', (e) => {
            if (link.target !== '_blank') {
                e.preventDefault();
                window.open(link.href, '_blank');
            }
        });
    });
});

function showSection(sectionId) {
    const mainMenu = document.getElementById('main-menu');
    const dynamicContent = document.getElementById('dynamic-content');
    mainMenu.style.display = 'none';
    dynamicContent.innerHTML = '';

    if (sectionId === 'main-menu') {
        mainMenu.style.display = 'block';
        return;
    }

    const sectionData = data[sectionId];
    if (sectionData) {
        const sectionHTML = `
            <div class="container">
                <h1>${sectionId === 'series' ? 'üé≠ –°–µ—Ä–∏–∞–ª—ã' : sectionId === 'films' ? 'üé¨ –§–∏–ª—å–º—ã' : sectionId === 'animation' ? 'ü§° –ú—É–ª—å—Ç—ã' : 'üò∏ –î–æ—Ä–∞–º—ã'}</h1>
                <div class="card-grid">
                    ${sectionData.map(item => `
                        <div class="card" onclick="showDetails('${sectionId}', '${item.id}')">
                            <img src="${item.image}" alt="${item.title}">
                            <h3>${item.title}</h3>
                        </div>
                    `).join('')}
                </div>
                <a href="#main-menu" class="menu-item" onclick="showSection('main-menu')">
                    <i class="fas fa-arrow-left"></i>
                    <span>–ù–∞–∑–∞–¥</span>
                </a>
            </div>
        `;
        dynamicContent.innerHTML = sectionHTML;
    }
}

// –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã
const searchInput = document.getElementById('search-input');
const searchButton = document.getElementById('search-button');

function performSearch() {
    const searchText = searchInput.value.toLowerCase();
    const mainMenu = document.getElementById('main-menu');
    const dynamicContent = document.getElementById('dynamic-content');

    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ä–µ–ª–∏–∑—ã, –ø—Ä–æ–≤–µ—Ä—è—è, —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–ª—é—á —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º
    const allReleases = [
        ...(data.series || []),
        ...(data.films || []),
        ...(data.animation || []),
        ...(data.dorama || [])
    ];

    if (searchText === '') {
        mainMenu.style.display = 'block';
        dynamicContent.innerHTML = '';
        return;
    }

    const filteredReleases = allReleases.filter(release => 
        release.title.toLowerCase().includes(searchText) || 
        release.description.toLowerCase().includes(searchText)
    );

    mainMenu.style.display = 'none';
    dynamicContent.innerHTML = '';

    if (filteredReleases.length > 0) {
        const searchResultsHTML = `
            <div class="container">
                <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h1>
                <div class="card-grid">
                    ${filteredReleases.map(release => `
                        <div class="card" onclick="showDetails('${release.id}')">
                            <img src="${release.image}" alt="${release.title}">
                            <h3>${release.title}</h3>
                        </div>
                    `).join('')}
                </div>
                <a href="#main-menu" class="menu-item" onclick="showSection('main-menu')">
                    <i class="fas fa-arrow-left"></i>
                    <span>–ù–∞–∑–∞–¥</span>
                </a>
            </div>
        `;
        dynamicContent.innerHTML = searchResultsHTML;
    } else {
        dynamicContent.innerHTML = `
            <div class="container">
                <h1>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h1>
                <a href="#main-menu" class="menu-item" onclick="showSection('main-menu')">
                    <i class="fas fa-arrow-left"></i>
                    <span>–ù–∞–∑–∞–¥</span>
                </a>
            </div>
        `;
    }
}

searchButton.addEventListener('click', performSearch);
searchInput.addEventListener('keypress', (event) => {
    if (event.key === 'Enter') {
        performSearch();
    }
});

function showDetails(sectionId, itemId) {
    const mainMenu = document.getElementById('main-menu');
    const dynamicContent = document.getElementById('dynamic-content');
    mainMenu.style.display = 'none';
    dynamicContent.innerHTML = '';

    const sectionData = data[sectionId];
    if (sectionData) {
        const item = sectionData.find(i => i.id === itemId);
        if (item) {
            const detailsHTML = `
                <div class="details-container">
                    <h1>${item.title}</h1>
                    <p>${item.description}</p>
                    <div class="details-buttons">
                        ${item.links.map(link => `
                            <a href="${link.link}" target="_blank">
                                <i class="${link.icon}"></i>
                                <span>${link.text}</span>
                            </a>
                        `).join('')}
                    </div>
                    <a href="#main-menu" class="menu-item" onclick="showSection('main-menu')">
                        <i class="fas fa-arrow-left"></i>
                        <span>–ù–∞–∑–∞–¥</span>
                    </a>
                </div>
            `;
            dynamicContent.innerHTML = detailsHTML;
        }
    }
}


